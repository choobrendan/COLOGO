(function(L,S){typeof exports=="object"&&typeof module=="object"?module.exports=S():typeof define=="function"&&define.amd?define([],S):typeof exports=="object"?exports.Vibrant=S():L.Vibrant=S()})(window,function(){return O={},L.m=S=[function(y,s,v){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.assignDeep=s.mapValues=void 0,s.mapValues=function(b,g){var h,c,i={};for(h in b)b.hasOwnProperty(h)&&(c=b[h],i[h]=g(c));return i},s.assignDeep=function b(g){for(var h=[],c=1;c<arguments.length;c++)h[c-1]=arguments[c];return h.forEach(function(i){if(i)for(var r in i){var t;i.hasOwnProperty(r)&&(t=i[r],Array.isArray(t)?g[r]=t.slice(0):typeof t=="object"?(g[r]||(g[r]={}),b(g[r],t)):g[r]=t)}}),g}},function(y,s,i){"use strict";var b=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s,"__esModule",{value:!0});var g=i(7),h=b(i(8)),c=i(0),i=(r.use=function(t){this._pipeline=t},r.from=function(t){return new h.default(t)},Object.defineProperty(r.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),r.prototype._process=function(t,e){return this.opts.quantizer,t.scaleDown(this.opts),e=g.buildProcessOptions(this.opts,e),r._pipeline.process(t.getImageData(),e)},r.prototype.palette=function(){return this.swatches()},r.prototype.swatches=function(){throw new Error("Method deprecated. Use `Vibrant.result.palettes[name]` instead")},r.prototype.getPalette=function(){var t=this,e=arguments[0],n=typeof e=="string"?e:"default",o=typeof e=="string"?arguments[1]:e,a=new this.opts.ImageClass;return a.load(this._src).then(function(l){return t._process(l,{generators:[n]})}).then(function(l){return(t._result=l).palettes[n]}).then(function(l){return a.remove(),o&&o(void 0,l),l}).catch(function(l){return a.remove(),o&&o(l),Promise.reject(l)})},r.prototype.getPalettes=function(){var t=this,e=arguments[0],n=arguments[1],o=Array.isArray(e)?e:["*"],a=Array.isArray(e)?n:e,l=new this.opts.ImageClass;return l.load(this._src).then(function(f){return t._process(f,{generators:o})}).then(function(f){return(t._result=f).palettes}).then(function(f){return l.remove(),a&&a(void 0,f),f}).catch(function(f){return l.remove(),a&&a(f),Promise.reject(f)})},r.DefaultOpts={colorCount:64,quality:5,filters:[]},r);function r(t,e){this._src=t,this.opts=c.assignDeep({},r.DefaultOpts,e)}s.default=i},function(y,s,v){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.applyFilters=s.ImageBase=void 0;var b=(g.prototype.scaleDown=function(h){var c,i=this.getWidth(),r=this.getHeight(),t=1;0<h.maxDimension?(c=Math.max(i,r))>h.maxDimension&&(t=h.maxDimension/c):t=1/h.quality,t<1&&this.resize(i*t,r*t,t)},g);function g(){}s.ImageBase=b,s.applyFilters=function(h,c){if(0<c.length)for(var i,r,t,e,n,o=h.data,a=o.length/4,l=0;l<a;l++){r=o[0+(i=4*l)],t=o[1+i],e=o[2+i],n=o[3+i];for(var f=0;f<c.length;f++)if(!c[f](r,t,e,n)){o[3+i]=0;break}}return h}},function(y,s,g){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Swatch=void 0;var b=g(4),g=(h.applyFilters=function(c,i){return 0<i.length?c.filter(function(r){for(var t=r.r,e=r.g,n=r.b,o=0;o<i.length;o++)if(!i[o](t,e,n,255))return!1;return!0}):c},h.clone=function(c){return new h(c._rgb,c._population)},Object.defineProperty(h.prototype,"r",{get:function(){return this._rgb[0]},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"g",{get:function(){return this._rgb[1]},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"b",{get:function(){return this._rgb[2]},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"rgb",{get:function(){return this._rgb},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"hsl",{get:function(){var c,i,r;return this._hsl||(c=(r=this._rgb)[0],i=r[1],r=r[2],this._hsl=b.rgbToHsl(c,i,r)),this._hsl},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"hex",{get:function(){var c,i,r;return this._hex||(c=(r=this._rgb)[0],i=r[1],r=r[2],this._hex=b.rgbToHex(c,i,r)),this._hex},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"population",{get:function(){return this._population},enumerable:!1,configurable:!0}),h.prototype.toJSON=function(){return{rgb:this.rgb,population:this.population}},h.prototype.getRgb=function(){return this._rgb},h.prototype.getHsl=function(){return this.hsl},h.prototype.getPopulation=function(){return this._population},h.prototype.getHex=function(){return this.hex},h.prototype.getYiq=function(){var c;return this._yiq||(c=this._rgb,this._yiq=(299*c[0]+587*c[1]+114*c[2])/1e3),this._yiq},Object.defineProperty(h.prototype,"titleTextColor",{get:function(){return this._titleTextColor&&(this._titleTextColor=this.getYiq()<200?"#fff":"#000"),this._titleTextColor},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"bodyTextColor",{get:function(){return this._bodyTextColor&&(this._bodyTextColor=this.getYiq()<150?"#fff":"#000"),this._bodyTextColor},enumerable:!1,configurable:!0}),h.prototype.getTitleTextColor=function(){return this.titleTextColor},h.prototype.getBodyTextColor=function(){return this.bodyTextColor},h);function h(c,i){this._rgb=c,this._population=i}s.Swatch=g},function(y,s,v){"use strict";function b(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!e)throw new RangeError("'"+t+"' is not a valid hex color");return[e[1],e[2],e[3]].map(function(n){return parseInt(n,16)})}function g(t,e,n){return e/=255,n/=255,t=.04045<(t/=255)?Math.pow((t+.005)/1.055,2.4):t/12.92,e=.04045<e?Math.pow((e+.005)/1.055,2.4):e/12.92,n=.04045<n?Math.pow((n+.005)/1.055,2.4):n/12.92,[.4124*(t*=100)+.3576*(e*=100)+.1805*(n*=100),.2126*t+.7152*e+.0722*n,.0193*t+.1192*e+.9505*n]}function h(t,e,n){return e/=100,n/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(e=.008856<e?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116))]}function c(t,e,n){return n=g(t,e,n),h(n[0],n[1],n[2])}function i(f,u){var d=f[0],n=f[1],m=f[2],o=u[0],a=u[1],p=u[2],l=d-o,f=n-a,u=m-p,m=Math.sqrt(n*n+m*m),d=o-d,p=Math.sqrt(a*a+p*p)-m,u=Math.sqrt(l*l+f*f+u*u),u=Math.sqrt(u)>Math.sqrt(Math.abs(d))+Math.sqrt(Math.abs(p))?Math.sqrt(u*u-d*d-p*p):0;return d/=1,p/=1+.045*m,u/=1+.015*m,Math.sqrt(d*d+p*p+u*u)}function r(t,e){return i(c.apply(void 0,t),c.apply(void 0,e))}Object.defineProperty(s,"__esModule",{value:!0}),s.getColorDiffStatus=s.hexDiff=s.rgbDiff=s.deltaE94=s.rgbToCIELab=s.xyzToCIELab=s.rgbToXyz=s.hslToRgb=s.rgbToHsl=s.rgbToHex=s.hexToRgb=s.DELTAE94_DIFF_STATUS=void 0,s.DELTAE94_DIFF_STATUS={NA:0,PERFECT:1,CLOSE:2,GOOD:10,SIMILAR:50},s.hexToRgb=b,s.rgbToHex=function(t,e,n){return"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1,7)},s.rgbToHsl=function(t,e,n){t/=255,e/=255,n/=255;var o=Math.max(t,e,n),a=Math.min(t,e,n),l=0,f=0,m=(o+a)/2;if(o!==a){var d=o-a,f=.5<m?d/(2-o-a):d/(o+a);switch(o){case t:l=(e-n)/d+(e<n?6:0);break;case e:l=(n-t)/d+2;break;case n:l=(t-e)/d+4}l/=6}return[l,f,m]},s.hslToRgb=function(t,e,n){var o,a,l;function f(m,d,p){return p<0&&(p+=1),1<p&&--p,p<1/6?m+6*(d-m)*p:p<.5?d:p<2/3?m+(d-m)*(2/3-p)*6:m}return e===0?o=a=l=n:(o=f(e=2*n-(n=n<.5?n*(1+e):n+e-n*e),n,t+1/3),a=f(e,n,t),l=f(e,n,t-1/3)),[255*o,255*a,255*l]},s.rgbToXyz=g,s.xyzToCIELab=h,s.rgbToCIELab=c,s.deltaE94=i,s.rgbDiff=r,s.hexDiff=function(t,e){return r(b(t),b(e))},s.getColorDiffStatus=function(t){return t<s.DELTAE94_DIFF_STATUS.NA?"N/A":t<=s.DELTAE94_DIFF_STATUS.PERFECT?"Perfect":t<=s.DELTAE94_DIFF_STATUS.CLOSE?"Close":t<=s.DELTAE94_DIFF_STATUS.GOOD?"Good":t<s.DELTAE94_DIFF_STATUS.SIMILAR?"Similar":"Wrong"}},function(y,s,h){"use strict";var b=this&&this.__importDefault||function(c){return c&&c.__esModule?c:{default:c}},g=b(h(6)),h=b(h(9));g.default.DefaultOpts.ImageClass=h.default,y.exports=g.default},function(y,s,v){"use strict";var b=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(s,"__esModule",{value:!0}),v=b(v(1)),v.default.DefaultOpts.quantizer="mmcq",v.default.DefaultOpts.generators=["default"],v.default.DefaultOpts.filters=["default"],s.default=v.default},function(y,s,v){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.buildProcessOptions=void 0;var b=v(0);s.buildProcessOptions=function(r,h){var t=r.colorCount,c=r.quantizer,i=r.generators,r=r.filters,t={colorCount:t};return(c=typeof c=="string"?{name:c,options:{}}:c).options=b.assignDeep({},t,c.options),b.assignDeep({},{quantizer:c,generators:i,filters:r},h)}},function(y,s,c){"use strict";var b=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(s,"__esModule",{value:!0});var g=b(c(1)),h=c(0),c=(i.prototype.maxColorCount=function(r){return this._opts.colorCount=r,this},i.prototype.maxDimension=function(r){return this._opts.maxDimension=r,this},i.prototype.addFilter=function(r){return this._opts.filters?this._opts.filters.push(r):this._opts.filters=[r],this},i.prototype.removeFilter=function(r){return!this._opts.filters||0<(r=this._opts.filters.indexOf(r))&&this._opts.filters.splice(r),this},i.prototype.clearFilters=function(){return this._opts.filters=[],this},i.prototype.quality=function(r){return this._opts.quality=r,this},i.prototype.useImageClass=function(r){return this._opts.ImageClass=r,this},i.prototype.useGenerator=function(r,t){return this._opts.generators||(this._opts.generators=[]),this._opts.generators.push(t?{name:r,options:t}:r),this},i.prototype.useQuantizer=function(r,t){return this._opts.quantizer=t?{name:r,options:t}:r,this},i.prototype.build=function(){return new g.default(this._src,this._opts)},i.prototype.getPalette=function(r){return this.build().getPalette(r)},i.prototype.getSwatches=function(r){return this.build().getPalette(r)},i);function i(r,t){t===void 0&&(t={}),this._src=r,this._opts=h.assignDeep({},g.default.DefaultOpts,t)}s.default=c},function(y,s,v){"use strict";var b,h=this&&this.__extends||(b=function(i,r){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(i,r)},function(i,r){function t(){this.constructor=i}b(i,r),i.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)});Object.defineProperty(s,"__esModule",{value:!0}),v=v(2);var g,h=(g=v.ImageBase,h(c,g),c.prototype._initCanvas=function(){var i=this.image,r=this._canvas=document.createElement("canvas"),t=r.getContext("2d");if(!t)throw new ReferenceError("Failed to create canvas context");this._context=t,r.className="@vibrant/canvas",r.style.display="none",this._width=r.width=i.width,this._height=r.height=i.height,t.drawImage(i,0,0),document.body.appendChild(r)},c.prototype.load=function(i){var r,t,e,n,o=this;if(typeof i=="string")r=document.createElement("img"),n=t=i,(n=new URL(n,location.href)).protocol===location.protocol&&n.host===location.host&&n.port===location.port||(e=window.location.href,n=t,e=new URL(e),n=new URL(n),e.protocol===n.protocol&&e.hostname===n.hostname&&e.port===n.port)||(r.crossOrigin="anonymous"),r.src=t;else{if(!(i instanceof HTMLImageElement))return Promise.reject(new Error("Cannot load buffer as an image in browser"));t=(r=i).src}return this.image=r,new Promise(function(a,l){function f(){o._initCanvas(),a(o)}r.complete?f():(r.onload=f,r.onerror=function(m){return l(new Error("Fail to load image: "+t))})})},c.prototype.clear=function(){this._context.clearRect(0,0,this._width,this._height)},c.prototype.update=function(i){this._context.putImageData(i,0,0)},c.prototype.getWidth=function(){return this._width},c.prototype.getHeight=function(){return this._height},c.prototype.resize=function(i,r,t){var e=this._canvas,n=this._context,o=this.image;this._width=e.width=i,this._height=e.height=r,n.scale(t,t),n.drawImage(o,0,0)},c.prototype.getPixelCount=function(){return this._width*this._height},c.prototype.getImageData=function(){return this._context.getImageData(0,0,this._width,this._height)},c.prototype.remove=function(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)},c);function c(){return g!==null&&g.apply(this,arguments)||this}s.default=h},function(y,s,h){"use strict";var b=this&&this.__importDefault||function(c){return c&&c.__esModule?c:{default:c}},g=h(5),h=b(h(11));g.use(h.default),y.exports=g},function(y,s,v){"use strict";var g=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(s,"__esModule",{value:!0});var b=g(v(12)),g=g(v(16)),g=new(v(17)).BasicPipeline().filter.register("default",function(h,c,i,r){return 125<=r&&!(250<h&&250<c&&250<i)}).quantizer.register("mmcq",b.default).generator.register("default",g.default);s.default=g},function(y,s,v){"use strict";var b=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(s,"__esModule",{value:!0});var g=v(3),h=b(v(13)),c=b(v(15));function i(r,t){for(var e=r.size();r.size()<t;){var n=r.pop();if(!(n&&0<n.count()))break;var o=n.split(),n=o[0],o=o[1];if(r.push(n),o&&0<o.count()&&r.push(o),r.size()===e)break;e=r.size()}}s.default=function(n,t){if(n.length===0||t.colorCount<2||256<t.colorCount)throw new Error("Wrong MMCQ parameters");var e=h.default.build(n),n=(e.histogram.colorCount,new c.default(function(o,a){return o.count()-a.count()}));return n.push(e),i(n,.75*t.colorCount),e=new c.default(function(o,a){return o.count()*o.volume()-a.count()*a.volume()}),e.contents=n.contents,i(e,t.colorCount-e.size()),function(o){for(var a=[];o.size();){var l=o.pop(),f=l.avg();f[0],f[1],f[2],a.push(new g.Swatch(f,l.count()))}return a}(e)}},function(y,s,h){"use strict";var b=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(s,"__esModule",{value:!0});var g=b(h(14)),h=(c.build=function(i){return i=new g.default(i,{sigBits:5}),new c(i.rmin,i.rmax,i.gmin,i.gmax,i.bmin,i.bmax,i)},c.prototype.invalidate=function(){this._volume=this._count=-1,this._avg=null},c.prototype.volume=function(){var i,r,t,e,n,o;return this._volume<0&&(i=(o=this.dimension).r1,r=o.r2,t=o.g1,e=o.g2,n=o.b1,o=o.b2,this._volume=(r-i+1)*(e-t+1)*(o-n+1)),this._volume},c.prototype.count=function(){if(this._count<0){for(var e=this.histogram,i=e.hist,r=e.getColorIndex,t=this.dimension,e=t.r1,n=t.r2,o=t.g1,a=t.g2,l=t.b1,f=t.b2,m=0,d=e;d<=n;d++)for(var p=o;p<=a;p++)for(var u=l;u<=f;u++)m+=i[r(d,p,u)];this._count=m}return this._count},c.prototype.clone=function(){var i=this.histogram,r=this.dimension;return new c(r.r1,r.r2,r.g1,r.g2,r.b1,r.b2,i)},c.prototype.avg=function(){if(!this._avg){for(var e=this.histogram,i=e.hist,r=e.getColorIndex,t=this.dimension,e=t.r1,n=t.r2,o=t.g1,a=t.g2,l=t.b1,f=t.b2,m=0,u=void 0,d=void 0,p=void 0,u=d=p=0,_=e;_<=n;_++)for(var w=o;w<=a;w++)for(var M=l;M<=f;M++){var x=i[r(_,w,M)];m+=x,u+=x*(_+.5)*8,d+=x*(w+.5)*8,p+=x*(M+.5)*8}this._avg=m?[~~(u/m),~~(d/m),~~(p/m)]:[~~(8*(e+n+1)/2),~~(8*(o+a+1)/2),~~(8*(l+f+1)/2)]}return this._avg},c.prototype.contains=function(f){var r=f[0],t=f[1],e=f[2],m=this.dimension,n=m.r1,o=m.r2,a=m.g1,l=m.g2,f=m.b1,m=m.b2;return t>>=3,e>>=3,n<=(r>>=3)&&r<=o&&a<=t&&t<=l&&f<=e&&e<=m},c.prototype.split=function(){var d=this.histogram,i=d.hist,r=d.getColorIndex,w=this.dimension,t=w.r1,e=w.r2,n=w.g1,o=w.g2,a=w.b1,l=w.b2,p=this.count();if(!p)return[];if(p===1)return[this.clone()];var f,m=e-t+1,d=o-n+1,w=l-a+1,p=Math.max(m,d,w),u=null,_=f=0,w=null;if(p===m){w="r",u=new Uint32Array(e+1);for(var M=t;M<=e;M++){_=0;for(var x=n;x<=o;x++)for(var D=a;D<=l;D++)_+=i[r(M,x,D)];f+=_,u[M]=f}}else if(p===d)for(w="g",u=new Uint32Array(o+1),x=n;x<=o;x++){for(_=0,M=t;M<=e;M++)for(D=a;D<=l;D++)_+=i[r(M,x,D)];f+=_,u[x]=f}else for(w="b",u=new Uint32Array(l+1),D=a;D<=l;D++){for(_=0,M=t;M<=e;M++)for(x=n;x<=o;x++)_+=i[r(M,x,D)];f+=_,u[D]=f}for(var T=-1,k=new Uint32Array(u.length),C=0;C<u.length;C++){var I=u[C];T<0&&f/2<I&&(T=C),k[C]=f-I}var V=this;return function(j){for(var A=j+"1",E=j+"2",q=V.dimension[A],P=V.dimension[E],z=V.clone(),F=V.clone(),R=T-q,P=R<=(j=P-T)?(P=Math.min(P-1,~~(T+j/2)),Math.max(0,P)):(P=Math.max(q,~~(T-1-R/2)),Math.min(V.dimension[E],P));!u[P];)P++;for(var N=k[P];!N&&u[P-1];)N=k[--P];return z.dimension[E]=P,F.dimension[A]=P+1,[z,F]}(w)},c);function c(i,r,t,e,n,o,a){this.histogram=a,this._volume=-1,this._count=-1,this.dimension={r1:i,r2:r,g1:t,g2:e,b1:n,b2:o}}s.default=h},function(y,s,v){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var b=(Object.defineProperty(g.prototype,"colorCount",{get:function(){return this._colorCount},enumerable:!1,configurable:!0}),g);function g(h,c){this.pixels=h;function i(x,D,T){return(x<<2*r)+(D<<r)+T}var r=(this.opts=c).sigBits;this.getColorIndex=i;for(var t,e,n,o,a,l,f,m=8-r,d=new Uint32Array(1<<3*r),p=t=n=0,u=e=o=Number.MAX_VALUE,_=h.length/4,w=0;w<_;){var M=4*w;w++,a=h[0+M],l=h[1+M],f=h[2+M],h[3+M]!==0&&(d[i(a>>=m,l>>=m,f>>=m)]+=1,p<a&&(p=a),a<u&&(u=a),t<l&&(t=l),l<e&&(e=l),n<f&&(n=f),f<o&&(o=f))}this._colorCount=d.reduce(function(x,D){return 0<D?x+1:x},0),this.hist=d,this.rmax=p,this.rmin=u,this.gmax=t,this.gmin=e,this.bmax=n,this.bmin=o}s.default=b},function(y,s,v){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var b=(g.prototype._sort=function(){this._sorted||(this.contents.sort(this._comparator),this._sorted=!0)},g.prototype.push=function(h){this.contents.push(h),this._sorted=!1},g.prototype.peek=function(h){return this._sort(),h=typeof h=="number"?h:this.contents.length-1,this.contents[h]},g.prototype.pop=function(){return this._sort(),this.contents.pop()},g.prototype.size=function(){return this.contents.length},g.prototype.map=function(h){return this._sort(),this.contents.map(h)},g);function g(h){this._comparator=h,this.contents=[],this._sorted=!1}s.default=b},function(y,s,v){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var b=v(3),g=v(4),h={targetDarkLuma:.26,maxDarkLuma:.45,minLightLuma:.55,targetLightLuma:.74,minNormalLuma:.3,targetNormalLuma:.5,maxNormalLuma:.7,targetMutesSaturation:.3,maxMutesSaturation:.4,targetVibrantSaturation:1,minVibrantSaturation:.35,weightSaturation:3,weightLuma:6.5,weightPopulation:.5};function c(r,t,e,n,o,a,l){function f(m,d){return 1-Math.abs(m-d)}return function(){for(var m=[],d=0;d<arguments.length;d++)m[d]=arguments[d];for(var p=0,u=0,_=0;_<m.length;_+=2){var w=m[_],M=m[_+1];p+=w*M,u+=M}return p/u}(f(r,t),l.weightSaturation,f(e,n),l.weightLuma,o/a,l.weightPopulation)}function i(r,t,e,n,o,a,l,f,m,d){var p=null,u=0;return t.forEach(function(_){var w,M=_.hsl,x=M[1],D=M[2];f<=x&&x<=m&&o<=D&&D<=a&&(w=_,(M=r).Vibrant!==w&&M.DarkVibrant!==w&&M.LightVibrant!==w&&M.Muted!==w&&M.DarkMuted!==w&&M.LightMuted!==w)&&(D=c(x,l,D,n,_.population,e,d),(p===null||u<D)&&(p=_,u=D))}),p}s.default=function(r,t){t=Object.assign({},h,t);var e,n,o,a,l,f,m,d,p,u,_=(e=0,r.forEach(function(w){e=Math.max(e,w.population)}),e),_=((o={Vibrant:null,DarkVibrant:null,LightVibrant:null,Muted:null,DarkMuted:null,LightMuted:null}).Vibrant=i(o,n=r,r=_,(_=t).targetNormalLuma,_.minNormalLuma,_.maxNormalLuma,_.targetVibrantSaturation,_.minVibrantSaturation,1,_),o.LightVibrant=i(o,n,r,_.targetLightLuma,_.minLightLuma,1,_.targetVibrantSaturation,_.minVibrantSaturation,1,_),o.DarkVibrant=i(o,n,r,_.targetDarkLuma,0,_.maxDarkLuma,_.targetVibrantSaturation,_.minVibrantSaturation,1,_),o.Muted=i(o,n,r,_.targetNormalLuma,_.minNormalLuma,_.maxNormalLuma,_.targetMutesSaturation,0,_.maxMutesSaturation,_),o.LightMuted=i(o,n,r,_.targetLightLuma,_.minLightLuma,1,_.targetMutesSaturation,0,_.maxMutesSaturation,_),o.DarkMuted=i(o,n,r,_.targetDarkLuma,0,_.maxDarkLuma,_.targetMutesSaturation,0,_.maxMutesSaturation,_),o);return o=t,(t=_).Vibrant||t.DarkVibrant||t.LightVibrant||(!t.DarkVibrant&&t.DarkMuted&&(d=(u=t.DarkMuted.hsl)[0],p=u[1],u=u[2],u=o.targetDarkLuma,t.DarkVibrant=new b.Swatch(g.hslToRgb(d,p,u),0)),!t.LightVibrant&&t.LightMuted&&(d=(a=t.LightMuted.hsl)[0],p=a[1],u=a[2],u=o.targetDarkLuma,t.DarkVibrant=new b.Swatch(g.hslToRgb(d,p,u),0))),!t.Vibrant&&t.DarkVibrant?(d=(a=t.DarkVibrant.hsl)[0],p=a[1],u=a[2],u=o.targetNormalLuma,t.Vibrant=new b.Swatch(g.hslToRgb(d,p,u),0)):!t.Vibrant&&t.LightVibrant&&(d=(l=t.LightVibrant.hsl)[0],p=l[1],u=l[2],u=o.targetNormalLuma,t.Vibrant=new b.Swatch(g.hslToRgb(d,p,u),0)),!t.DarkVibrant&&t.Vibrant&&(d=(l=t.Vibrant.hsl)[0],p=l[1],u=l[2],u=o.targetDarkLuma,t.DarkVibrant=new b.Swatch(g.hslToRgb(d,p,u),0)),!t.LightVibrant&&t.Vibrant&&(d=(f=t.Vibrant.hsl)[0],p=f[1],u=f[2],u=o.targetLightLuma,t.LightVibrant=new b.Swatch(g.hslToRgb(d,p,u),0)),!t.Muted&&t.Vibrant&&(d=(f=t.Vibrant.hsl)[0],p=f[1],u=f[2],u=o.targetMutesSaturation,t.Muted=new b.Swatch(g.hslToRgb(d,p,u),0)),!t.DarkMuted&&t.DarkVibrant&&(d=(m=t.DarkVibrant.hsl)[0],p=m[1],u=m[2],u=o.targetMutesSaturation,t.DarkMuted=new b.Swatch(g.hslToRgb(d,p,u),0)),!t.LightMuted&&t.LightVibrant&&(d=(m=t.LightVibrant.hsl)[0],p=m[1],u=m[2],u=o.targetMutesSaturation,t.LightMuted=new b.Swatch(g.hslToRgb(d,p,u),0)),_}},function(y,s,v){"use strict";var b=this&&this.__awaiter||function(t,e,n,o){return new(n=n||Promise)(function(a,l){function f(p){try{d(o.next(p))}catch(u){l(u)}}function m(p){try{d(o.throw(p))}catch(u){l(u)}}function d(p){var u;p.done?a(p.value):((u=p.value)instanceof n?u:new n(function(_){_(u)})).then(f,m)}d((o=o.apply(t,e||[])).next())})},g=this&&this.__generator||function(t,e){var n,o,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},f={next:m(0),throw:m(1),return:m(2)};return typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function m(d){return function(p){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(a=2&u[0]?o.return:u[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,u[1])).done)return a;switch(o=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return l.label++,{value:u[1],done:!1};case 5:l.label++,o=u[1],u=[0];continue;case 7:u=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(u[0]===6||u[0]===2)){l=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){l.label=u[1];break}if(u[0]===6&&l.label<a[1]){l.label=a[1],a=u;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(u);break}a[2]&&l.ops.pop(),l.trys.pop();continue}u=e.call(t,l)}catch(_){u=[6,_],o=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([d,p])}}};Object.defineProperty(s,"__esModule",{value:!0}),s.BasicPipeline=s.Stage=void 0;var h=v(2),c=(i.prototype.names=function(){return Object.keys(this._map)},i.prototype.has=function(t){return!!this._map[t]},i.prototype.get=function(t){return this._map[t]},i.prototype.register=function(t,e){return this._map[t]=e,this.pipeline},i);function i(t){this.pipeline=t,this._map={}}s.Stage=c,r.prototype._buildProcessTasks=function(a){var e=this,n=a.filters,o=a.quantizer,a=a.generators;return a.length===1&&a[0]==="*"&&(a=this.generator.names()),{filters:n.map(function(f){return l(e.filter,f)}),quantizer:l(this.quantizer,o),generators:a.map(function(f){return l(e.generator,f)})};function l(f,m){var d,p;return typeof m=="string"?d=m:(d=m.name,p=m.options),{name:d,fn:f.get(d),options:p}}},r.prototype.process=function(t,e){return b(this,void 0,void 0,function(){var n,o,a,l;return g(this,function(f){switch(f.label){case 0:return l=this._buildProcessTasks(e),o=l.filters,n=l.quantizer,l=l.generators,[4,this._filterColors(o,t)];case 1:return o=f.sent(),[4,this._generateColors(n,o)];case 2:return a=f.sent(),[4,this._generatePalettes(l,a)];case 3:return l=f.sent(),[2,{colors:a,palettes:l}]}})})},r.prototype._filterColors=function(t,e){return Promise.resolve(h.applyFilters(e,t.map(function(n){return n.fn})))},r.prototype._generateColors=function(t,e){return Promise.resolve(t.fn(e.data,t.options))},r.prototype._generatePalettes=function(t,e){return b(this,void 0,void 0,function(){var n;return g(this,function(o){switch(o.label){case 0:return[4,Promise.all(t.map(function(f){var l=f.fn,f=f.options;return Promise.resolve(l(e,f))}))];case 1:return n=o.sent(),[2,Promise.resolve(n.reduce(function(a,l,f){return a[t[f].name]=l,a},{}))]}})})},v=r;function r(){this.filter=new c(this),this.quantizer=new c(this),this.generator=new c(this)}s.BasicPipeline=v}],L.c=O,L.d=function(y,s,v){L.o(y,s)||Object.defineProperty(y,s,{enumerable:!0,get:v})},L.r=function(y){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})},L.t=function(y,s){if(1&s&&(y=L(y)),8&s||4&s&&typeof y=="object"&&y&&y.__esModule)return y;var v=Object.create(null);if(L.r(v),Object.defineProperty(v,"default",{enumerable:!0,value:y}),2&s&&typeof y!="string")for(var b in y)L.d(v,b,(function(g){return y[g]}).bind(null,b));return v},L.n=function(y){var s=y&&y.__esModule?function(){return y.default}:function(){return y};return L.d(s,"a",s),s},L.o=function(y,s){return Object.prototype.hasOwnProperty.call(y,s)},L.p="",L(L.s=10);function L(y){if(O[y])return O[y].exports;var s=O[y]={i:y,l:!1,exports:{}};return S[y].call(s.exports,s,s.exports,L),s.l=!0,s.exports}var S,O});
